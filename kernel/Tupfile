include_rules

INCLUDES=-I../include

OBJECTS=$(OBJECTS) libk/*.o prog/*.o util/*.o early/*.o

ifeq (@(TARGET_ARCH),i686)
	OBJECTS=$(OBJECTS) i686/*.o i686/boot/*.o i686/util/*.o
else
ifeq (@(TARGET_ARCH),x86_64)
	OBJECTS=$(OBJECTS) x86_64/*.o x86_64/boot/*.o x86_64/util/*.o
endif
endif

: foreach *.s *.c *.cpp                  |> !COMPILER_CPP $(CPP_FLAGS)       |>
: *.o $(OBJECTS) | $(KERNEL_LINK_SCRIPT) |> !LINKER -T $(KERNEL_LINK_SCRIPT) |> $(P_EXEC).bin
